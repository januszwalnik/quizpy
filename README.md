# üìö QuizPy

A lightweight, MongoDB-backed quiz application with a modern Tkinter UI.

- üß© Purpose: Create, manage and take multiple-choice quizzes stored in MongoDB. Supports single-answer and multi-select questions, JSON import/export, and explanations for each question.
- üé® UI: Modernized Tkinter + ttk styles with accessible keyboard shortcuts and centered dialogs.
- üê≥ Packaging: Intended to run in Docker, but can also be run locally.

**Features**
- Add / edit / delete questions
- Import and export questions as JSON
- Multi-select questions (questions where `correct` is a list of indices)
- Detailed results with per-question feedback and explanations
- Robust clipboard handling (falls back to file save when clipboard unavailable)
- Structured logging to `app.log` and stdout

## Quick start (local)
Requirements: Python 3.8+, `pymongo`, and a running MongoDB instance.

1. Install dependencies:

```bash
python3 -m pip install -r requirements.txt
```

2. Configure MongoDB access via `MONGO_URI` environment variable if needed. Default (development) URI is:

```
mongodb://quizadmin:quizpass123@localhost:27017/quizdb?authSource=admin
```

3. Run the app:

```bash
python3 app.py
```

Notes:
- If you see "Failed to initialize Tkinter" or "X connection to :0 broken", run with X available or use a virtual framebuffer:

```bash
xvfb-run -s "-screen 0 1024x768x24" python3 app.py
```

- To run inside Docker with GUI forwarded to your host, start the container passing `DISPLAY` and mounting `/tmp/.X11-unix`, and ensure X access is allowed for the container user.

## Quick start (Docker)
A `docker-compose.yml` may be included to run the app and MongoDB. When running the GUI in a container, forward X or use `xvfb` inside the container.

Example run (host X forwarding):

```bash
docker compose up --build
# or when running docker run:
# docker run -e DISPLAY=$DISPLAY -v /tmp/.X11-unix:/tmp/.X11-unix -v $XAUTHORITY:/root/.Xauthority <image>
```

## Logging
- Logs are written to `app.log` and to stdout. Control level with `LOG_LEVEL` env var (e.g., `export LOG_LEVEL=DEBUG`).

## JSON import/export
- Import expects an array of objects with keys: `question`, `options`, `correct`, `explanation`.
  - `correct` may be an integer (single correct index) or a list of integers (multi-select).
- Exported JSON is human-readable and can be copied to the clipboard; if clipboard access fails the app offers to save the JSON to a file.
- A helper script `scripts/fix_question_json.py` is provided to clean MongoDB-exported JSON (strips `_id` and `createdAt`).

Usage:

```bash
python3 scripts/fix_question_json.py question_7.json question_7_clean.json
```

## Development notes
- Main app file: `app.py`
- DB helper: `DatabaseConnection` (wraps PyMongo)
- CLI environment variables:
  - `MONGO_URI` ‚Äî connection string for MongoDB
  - `LOG_LEVEL` ‚Äî logging level (DEBUG/INFO/WARNING/ERROR)

## Troubleshooting
- "X connection to :0 broken": your X server connection closed. Try running locally on a machine with a display, use X forwarding over SSH, or run under `xvfb-run`.
- Clipboard errors: the app will try the root clipboard then offer to save to a file. See `app.log` for details.

## Contributing
Contributions welcome ‚Äî open an issue or submit a PR. Keep edits focused and run the app locally to verify UI and behavior.

---
Generated by the project maintainer tools.
